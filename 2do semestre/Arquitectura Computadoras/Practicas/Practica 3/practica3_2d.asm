PIC EQU 20H
PA EQU 30H
PB EQU 31H
CA EQU 32H
CB EQU 33H
ORG 40 ; ID 10 * 4 = 40
	IP_F10 DW RUT_F10
ORG 1000H
	LEER DB 1
	CADENA DB ?
ORG 3000H
RUT_F10: MOV LEER, 0
	MOV AL, 20H
	OUT PIC, AL
	IRET
ORG 2000H
	CLI
	MOV AL, 0FEH
	OUT PIC+1, AL
	MOV AL, 10 ; se asigna ID 10 a la interrupcion del F10 (INT 0)
	OUT PIC+4, AL
	MOV CX, 0
	MOV BX, OFFSET CADENA
	STI
LECTURA: INT 6
	INC BX
	INC CX
	CMP LEER, 1
	JZ LECTURA
	SUB BX, CX
	MOV AL, 0FFH
	OUT PIC+1, AL

	MOV AL, 0FDH
	OUT CA, AL
	MOV AL, 0
	OUT CB, AL
POLL: IN AL, PA
	AND AL, 1
	JNZ POLL

	MOV AL, [BX]
	OUT PB, AL
	
	IN AL, PA
	OR AL, 2
	OUT PA, AL

	IN AL, PA
	AND AL, 0FDH
	OUT PA, AL

	INC BX
	DEC CX
	JNZ POLL
	INT 0
END
